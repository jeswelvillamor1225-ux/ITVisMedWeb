<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile - VISMED Admin Portal</title>
    <link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Sans:wght@300;400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --navy: #0a1628;
            --navy2: #0d1f3c;
            --blue: #1a3a6b;
            --accent: #2f80ed;
            --accent2: #56ccf2;
            --glass: rgba(255,255,255,0.05);
            --glass-border: rgba(255,255,255,0.1);
            --text: #e8f0fe;
            --muted: #8aa0c0;
            --danger: #e74c3c;
            --success: #27ae60;
            --warning: #f39c12;
        }

        * { margin:0; padding:0; box-sizing:border-box; }
        body {
            font-family: 'DM Sans', sans-serif;
            background: var(--navy);
            color: var(--text);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .bg-mesh {
            position: fixed; inset: 0; z-index: 0; pointer-events: none;
            background:
                radial-gradient(ellipse 80% 60% at 70% 20%, rgba(47,128,237,0.18) 0%, transparent 60%),
                radial-gradient(ellipse 50% 40% at 10% 80%, rgba(86,204,242,0.1) 0%, transparent 50%),
                var(--navy);
        }

        .container {
            position: relative; z-index: 1; max-width: 1200px; margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(13,31,60,0.85);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 24px;
            backdrop-filter: blur(24px);
            margin-bottom: 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h1 {
            font-family: 'Syne', sans-serif;
            font-size: 28px;
            font-weight: 800;
            color: var(--accent2);
        }

        .header-actions {
            display: flex; gap: 12px;
        }

        .btn {
            padding: 10px 20px; border: none; border-radius: 8px;
            font-family: 'DM Sans', sans-serif; font-weight: 600;
            cursor: pointer; transition: all 0.2s;
            text-decoration: none; display: inline-flex; align-items: center; gap: 8px;
        }

        .btn-primary {
            background: var(--accent); color: white;
        }
        .btn-primary:hover {
            background: #1a6fd4; transform: translateY(-1px);
        }

        .btn-secondary {
            background: transparent; color: var(--text);
            border: 1px solid var(--glass-border);
        }
        .btn-secondary:hover {
            background: rgba(255,255,255,0.1);
        }

        .profile-grid {
            display: grid; grid-template-columns: 1fr 2fr; gap: 24px;
        }

        .profile-card {
            background: rgba(13,31,60,0.7); border: 1px solid var(--glass-border);
            border-radius: 16px; padding: 32px; backdrop-filter: blur(12px);
            text-align: center;
        }

        .profile-avatar {
            width: 120px; height: 120px; border-radius: 50%;
            background: linear-gradient(135deg, var(--accent), var(--accent2));
            display: flex; align-items: center; justify-content: center;
            font-family: 'Syne', sans-serif; font-weight: 800; font-size: 48px;
            margin: 0 auto 20px;
            color: white;
        }

        .profile-name {
            font-family: 'Syne', sans-serif; font-size: 24px; font-weight: 700;
            margin-bottom: 8px;
        }

        .profile-role {
            color: var(--muted); font-size: 16px; margin-bottom: 20px;
        }

        .profile-stats {
            display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-top: 24px;
        }

        .stat-item {
            padding: 16px; background: rgba(255,255,255,0.05); border-radius: 8px;
        }

        .stat-value {
            font-family: 'Syne', sans-serif; font-size: 24px; font-weight: 700;
            color: var(--accent2); margin-bottom: 4px;
        }

        .stat-label {
            color: var(--muted); font-size: 12px; text-transform: uppercase;
            letter-spacing: 1px;
        }

        .info-card {
            background: rgba(13,31,60,0.7); border: 1px solid var(--glass-border);
            border-radius: 16px; padding: 32px; backdrop-filter: blur(12px);
        }

        .info-section {
            margin-bottom: 32px;
        }

        .info-section h3 {
            font-family: 'Syne', sans-serif; font-size: 20px; font-weight: 700;
            margin-bottom: 20px; color: var(--accent2);
        }

        .info-grid {
            display: grid; grid-template-columns: 1fr 1fr; gap: 20px;
        }

        .info-item {
            padding: 16px; background: rgba(255,255,255,0.05); border-radius: 8px;
        }

        .info-label {
            color: var(--muted); font-size: 12px; text-transform: uppercase;
            letter-spacing: 1px; margin-bottom: 8px;
        }

        .info-value {
            font-size: 16px; font-weight: 500;
        }

        .activity-list {
            display: flex; flex-direction: column; gap: 12px;
        }

        .activity-item {
            padding: 16px; background: rgba(255,255,255,0.05); border-radius: 8px;
            border-left: 3px solid var(--accent);
        }

        .activity-title {
            font-weight: 600; margin-bottom: 4px;
        }

        .activity-meta {
            color: var(--muted); font-size: 14px;
        }

        .modal-overlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.7);
            z-index: 999; display: flex; align-items: center; justify-content: center;
            backdrop-filter: blur(4px);
        }

        .modal {
            background: rgba(13,31,60,0.98); border: 1px solid var(--glass-border);
            border-radius: 16px; padding: 32px; width: 100%; max-width: 500px;
            max-height: 90vh; overflow-y: auto;
        }

        .modal h2 {
            font-family: 'Syne', sans-serif; font-size: 24px; font-weight: 800;
            margin-bottom: 20px; color: var(--accent2);
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-group label {
            display: block; font-size: 12px; font-weight: 500;
            color: var(--muted); letter-spacing: 0.5px; margin-bottom: 8px;
            text-transform: uppercase;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%; padding: 12px 16px;
            background: rgba(255,255,255,0.06); border: 1px solid var(--glass-border);
            border-radius: 8px; color: var(--text); font-family: 'DM Sans', sans-serif;
            font-size: 14px; transition: border-color 0.2s;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none; border-color: var(--accent);
        }

        .modal-footer {
            display: flex; gap: 12px; justify-content: flex-end; margin-top: 24px;
        }

        .hidden { display: none !important; }

        .badge {
            padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: 600;
        }

        .badge-admin {
            background: linear-gradient(135deg, #f39c12, #e67e22); color: #fff;
        }

        .badge-user {
            background: rgba(47,128,237,0.25); color: var(--accent2);
            border: 1px solid rgba(86,204,242,0.3);
        }

        @media (max-width: 768px) {
            .header { flex-direction: column; gap: 16px; }
            .profile-grid { grid-template-columns: 1fr; }
            .info-grid { grid-template-columns: 1fr; }
            .profile-stats { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="bg-mesh"></div>
    
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div>
                <h1>üë§ My Profile</h1>
                <p style="color: var(--muted); margin-top: 4px;">Manage your account settings and preferences</p>
            </div>
            <div class="header-actions">
                <button class="btn btn-secondary" onclick="goBack()">
                    ‚Üê Go Back
                </button>
                <a href="admin.html" class="btn btn-secondary">
                    ‚Üê Back to Portal
                </a>
                <button class="btn btn-primary" onclick="openEditProfileModal()">
                    ‚úèÔ∏è Edit Profile
                </button>
            </div>
        </div>

        <!-- Profile Grid -->
        <div class="profile-grid">
            <!-- Profile Card -->
            <div class="profile-card">
                <div class="profile-avatar" id="profileAvatar">SA</div>
                <div class="profile-name" id="profileName">System Administrator</div>
                <div class="profile-role" id="profileRole">IT Department ¬∑ Admin</div>
                <span class="badge badge-admin">ADMIN</span>
                
                <div class="profile-stats">
                    <div class="stat-item">
                        <div class="stat-value" id="ticketsCreated">0</div>
                        <div class="stat-label">Tickets Created</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="announcementsPosted">0</div>
                        <div class="stat-label">Announcements Posted</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="usersManaged">0</div>
                        <div class="stat-label">Users Managed</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="daysActive">0</div>
                        <div class="stat-label">Days Active</div>
                    </div>
                </div>
            </div>

            <!-- Information Card -->
            <div class="info-card">
                <!-- Personal Information -->
                <div class="info-section">
                    <h3>üìã Personal Information</h3>
                    <div class="info-grid">
                        <div class="info-item">
                            <div class="info-label">Full Name</div>
                            <div class="info-value" id="infoName">System Administrator</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">Email Address</div>
                            <div class="info-value" id="infoEmail">admin@visayasmed.com.ph</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">Department</div>
                            <div class="info-value" id="infoDepartment">IT Department</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">Role</div>
                            <div class="info-value">
                                <span class="badge badge-admin">Administrator</span>
                            </div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">Account Status</div>
                            <div class="info-value">
                                <span style="color: #2ecc71;">‚óè Active</span>
                            </div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">Member Since</div>
                            <div class="info-value" id="infoJoinDate">January 1, 2025</div>
                        </div>
                    </div>
                </div>

                <!-- Recent Activity -->
                <div class="info-section">
                    <h3>üìä Recent Activity</h3>
                    <div class="activity-list" id="activityList">
                        <!-- Activities will be populated here -->
                    </div>
                </div>

                <!-- System Access -->
                <div class="info-section">
                    <h3>üîê System Access</h3>
                    <div class="info-grid">
                        <div class="info-item">
                            <div class="info-label">User Management</div>
                            <div class="info-value">
                                <span style="color: #2ecc71;">‚úì Full Access</span>
                            </div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">Ticket Management</div>
                            <div class="info-value">
                                <span style="color: #2ecc71;">‚úì Full Access</span>
                            </div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">Announcements</div>
                            <div class="info-value">
                                <span style="color: #2ecc71;">‚úì Full Access</span>
                            </div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">System Settings</div>
                            <div class="info-value">
                                <span style="color: #2ecc71;">‚úì Full Access</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Profile Modal -->
    <div id="editProfileModal" class="modal-overlay hidden">
        <div class="modal">
            <h2>‚úèÔ∏è Edit Profile</h2>
            <form id="editProfileForm">
                <div class="form-group">
                    <label>Full Name</label>
                    <input type="text" id="editName" required>
                </div>
                
                <div class="form-group">
                    <label>Email Address</label>
                    <input type="email" id="editEmail" required>
                </div>
                
                <div class="form-group">
                    <label>Department</label>
                    <select id="editDepartment" required>
                        <option value="IT Department">IT Department</option>
                        <option value="Nursing">Nursing</option>
                        <option value="Radiology">Radiology</option>
                        <option value="Laboratory">Laboratory</option>
                        <option value="Pharmacy">Pharmacy</option>
                        <option value="Administration">Administration</option>
                        <option value="Finance">Finance</option>
                        <option value="Maintenance">Maintenance</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Current Password</label>
                    <input type="password" id="currentPassword" placeholder="Enter current password">
                </div>
                
                <div class="form-group">
                    <label>New Password (optional)</label>
                    <input type="password" id="newPassword" placeholder="Leave blank to keep current password">
                </div>
                
                <div class="form-group">
                    <label>Confirm New Password</label>
                    <input type="password" id="confirmPassword" placeholder="Confirm new password">
                </div>
                
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeEditProfileModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Changes</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Check for existing session on page load
        document.addEventListener('DOMContentLoaded', function() {
            const savedUser = localStorage.getItem('currentUser');
            if (!savedUser) {
                // Redirect to admin login if not authenticated
                window.location.href = 'admin.html';
                return;
            }
            
            // Initialize page
            loadProfile();
            renderActivities();
            updateStats();
        });

        // User profile data
        let userProfile = {
            name: "System Administrator",
            email: "admin@visayasmed.com.ph",
            department: "IT Department",
            role: "admin",
            joinDate: "2025-01-01",
            ticketsCreated: 15,
            announcementsPosted: 8,
            usersManaged: 12
        };

        // Sample activities
        let activities = [
            {
                title: "Created new user account",
                description: "Added Juan Dela Cruz to the system",
                date: "2026-02-27",
                type: "user"
            },
            {
                title: "Posted announcement",
                description: "Scheduled maintenance notice for March 1",
                date: "2026-02-26",
                type: "announcement"
            },
            {
                title: "Resolved ticket #1005",
                description: "Fixed network connectivity issue in Ward 2",
                date: "2026-02-25",
                type: "ticket"
            },
            {
                title: "Updated system settings",
                description: "Modified password policy requirements",
                date: "2026-02-24",
                type: "system"
            }
        ];

        // Go back function
        function goBack() {
            window.history.back();
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            loadProfile();
            renderActivities();
            updateStats();
        });

        // Load profile data
        function loadProfile() {
            // Update profile card
            const initials = userProfile.name.split(' ').map(w => w[0]).join('').slice(0, 2).toUpperCase();
            document.getElementById('profileAvatar').textContent = initials;
            document.getElementById('profileName').textContent = userProfile.name;
            document.getElementById('profileRole').textContent = `${userProfile.department} ¬∑ ${userProfile.role === 'admin' ? 'Admin' : 'User'}`;
            
            // Update information section
            document.getElementById('infoName').textContent = userProfile.name;
            document.getElementById('infoEmail').textContent = userProfile.email;
            document.getElementById('infoDepartment').textContent = userProfile.department;
            document.getElementById('infoJoinDate').textContent = formatDate(userProfile.joinDate);
            
            // Update role badge
            const roleBadge = document.querySelector('.badge');
            if (userProfile.role === 'admin') {
                roleBadge.className = 'badge badge-admin';
                roleBadge.textContent = 'ADMIN';
            } else {
                roleBadge.className = 'badge badge-user';
                roleBadge.textContent = 'USER';
            }
        }

        // Render activities
        function renderActivities() {
            const container = document.getElementById('activityList');
            
            if (activities.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: var(--muted);">
                        <div style="font-size: 32px; margin-bottom: 8px;">üìã</div>
                        <p>No recent activity</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = activities.map(activity => `
                <div class="activity-item">
                    <div class="activity-title">${getActivityIcon(activity.type)} ${activity.title}</div>
                    <div class="activity-meta">${activity.description} ¬∑ ${formatDate(activity.date)}</div>
                </div>
            `).join('');
        }

        // Get activity icon
        function getActivityIcon(type) {
            const icons = {
                'user': 'üë§',
                'announcement': 'üì£',
                'ticket': 'üé´',
                'system': '‚öôÔ∏è'
            };
            return icons[type] || 'üìã';
        }

        // Update statistics
        function updateStats() {
            document.getElementById('ticketsCreated').textContent = userProfile.ticketsCreated;
            document.getElementById('announcementsPosted').textContent = userProfile.announcementsPosted;
            document.getElementById('usersManaged').textContent = userProfile.usersManaged;
            
            // Calculate days active
            const joinDate = new Date(userProfile.joinDate);
            const today = new Date();
            const daysActive = Math.floor((today - joinDate) / (1000 * 60 * 60 * 24));
            document.getElementById('daysActive').textContent = daysActive;
        }

        // Format date
        function formatDate(dateString) {
            const options = { year: 'numeric', month: 'long', day: 'numeric' };
            return new Date(dateString).toLocaleDateString(undefined, options);
        }

        // Open edit profile modal
        function openEditProfileModal() {
            document.getElementById('editName').value = userProfile.name;
            document.getElementById('editEmail').value = userProfile.email;
            document.getElementById('editDepartment').value = userProfile.department;
            
            document.getElementById('editProfileModal').classList.remove('hidden');
        }

        // Close edit profile modal
        function closeEditProfileModal() {
            document.getElementById('editProfileModal').classList.add('hidden');
            document.getElementById('editProfileForm').reset();
        }

        // Handle edit profile submission
        document.getElementById('editProfileForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const newName = document.getElementById('editName').value;
            const newEmail = document.getElementById('editEmail').value;
            const newDepartment = document.getElementById('editDepartment').value;
            const currentPassword = document.getElementById('currentPassword').value;
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            
            // Validate password if changing
            if (newPassword) {
                if (newPassword !== confirmPassword) {
                    alert('New passwords do not match!');
                    return;
                }
                if (newPassword.length < 8) {
                    alert('Password must be at least 8 characters long!');
                    return;
                }
            }
            
            // Update profile
            userProfile.name = newName;
            userProfile.email = newEmail;
            userProfile.department = newDepartment;
            
            // Add activity
            activities.unshift({
                title: "Updated profile information",
                description: "Modified personal details and settings",
                date: new Date().toISOString().split('T')[0],
                type: "system"
            });
            
            // Keep only last 10 activities
            activities = activities.slice(0, 10);
            
            loadProfile();
            renderActivities();
            closeEditProfileModal();
            
            alert('Profile updated successfully!');
        });

        // Close modal on overlay click
        document.getElementById('editProfileModal').addEventListener('click', function(e) {
            if (e.target === this) closeEditProfileModal();
        });
    </script>
</body>
</html>
